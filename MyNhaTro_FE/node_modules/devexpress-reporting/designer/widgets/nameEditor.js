/**
* DevExpress HTML/JS Reporting (designer\widgets\nameEditor.js)
* Version:  22.2.14
* Build date: Oct 28, 2024
* Copyright (c) 2012 - 2024 Developer Express Inc. ALL RIGHTS RESERVED
* License: https://www.devexpress.com/Support/EULAs/universal.xml
*/
import { getLocalization } from '@devexpress/analytics-core/analytics-utils';
import { Editor } from '@devexpress/analytics-core/analytics-widgets';
import * as $ from 'jquery';
import * as ko from 'knockout';
export class NameEditor extends Editor {
    constructor(info, level, parentDisabled, textToSearch) {
        super(info, level, parentDisabled, textToSearch);
        this.currentValidationRules = ko.observable(super._getEditorValidationRules());
    }
    _getEditorValidationRules() {
        return this.currentValidationRules();
    }
    generateRules(allControls) {
        var self = this;
        if (self.disabled())
            return [];
        this.currentValidationRules([{
                type: 'custom',
                validationCallback: (options) => {
                    if (options.value == null)
                        return false;
                    return allControls().filter(x => {
                        if (ko.unwrap(x.name).toLowerCase() !== options.value.toLowerCase())
                            return false;
                        var model = self._model();
                        if (!model || x === model)
                            return false;
                        var same = model['isSame'];
                        if (same && $.isFunction(same) && same(x))
                            return false;
                        return true;
                    }).length === 0;
                },
                get message() { return getLocalization('Name is not unique', 'ASPxReportsStringId.ReportDesigner_NameUniqueError'); }
            }].concat(super._getEditorValidationRules()));
        return this.currentValidationRules();
    }
}
